# 网站迁移到微信小程序指南

## 一、核心区别

| 网页 | 微信小程序 |
|------|-----------|
| HTML | WXML |
| CSS | WXSS |
| JavaScript | JavaScript (有限制) |
| localStorage | wx.setStorage |
| 浏览器 API | 微信专用 API |
| 自由部署 | 需微信审核 |

## 二、迁移步骤

### 1. 注册小程序
- 访问 https://mp.weixin.qq.com
- 注册小程序账号
- 获取 AppID

### 2. 安装开发工具
- 下载微信开发者工具
- 创建新项目，填入 AppID

### 3. 文件结构转换

**网页结构：**
```
index.html
app.js
styles.css
```

**小程序结构：**
```
pages/
  index/
    index.wxml    ← HTML
    index.wxss    ← CSS
    index.js      ← JS
    index.json    ← 页面配置
app.js            ← 小程序入口
app.json          ← 全局配置
app.wxss          ← 全局样式
```

## 三、代码转换示例

### HTML → WXML

**原网页：**
```html
<div class="section">
  <h2 class="section-title">📅 每周回顾</h2>
  <div class="highlight-box">
    <p>市场回顾内容...</p>
  </div>
</div>
```

**小程序：**
```xml
<view class="section">
  <text class="section-title">📅 每周回顾</text>
  <view class="highlight-box">
    <text>市场回顾内容...</text>
  </view>
</view>
```

**标签对应：**
| HTML | WXML |
|------|------|
| div | view |
| span/text | text |
| img | image |
| a | navigator |
| button | button |

### CSS → WXSS

**基本兼容**，但注意：
- 不支持 `*` 选择器
- 不支持部分 CSS3 属性
- 单位可以用 rpx（响应式像素）

```css
/* 网页 */
.container {
  max-width: 800px;
  padding: 40px 20px;
}

/* 小程序 */
.container {
  width: 750rpx;  /* 全屏宽度 */
  padding: 40rpx 20rpx;
}
```

### JavaScript 转换

**数据存储：**
```javascript
// 网页
localStorage.setItem('key', value);
localStorage.getItem('key');

// 小程序
wx.setStorageSync('key', value);
wx.getStorageSync('key');
```

**网络请求：**
```javascript
// 网页
fetch('/api/data')
  .then(res => res.json())
  .then(data => console.log(data));

// 小程序
wx.request({
  url: 'https://your-api.com/data',
  success: (res) => {
    console.log(res.data);
  }
});
```

**页面跳转：**
```javascript
// 网页
window.location.href = '/page.html';

// 小程序
wx.navigateTo({
  url: '/pages/detail/detail'
});
```

## 四、功能适配

### 1. 账号系统
小程序有 openid，可以替代本地账号：
```javascript
wx.login({
  success: (res) => {
    // 用 res.code 换取 openid
  }
});
```

### 2. 主题切换
逻辑相同，但用 wxss 变量：
```css
/* app.wxss */
page {
  --bg-primary: #f5f0e8;
}

page.theme-dark {
  --bg-primary: #1a1a2e;
}
```

### 3. 收藏功能
用 wx.setStorageSync 替代 localStorage

### 4. 番茄钟
用 setInterval，但注意小程序后台会暂停

## 五、小程序特有优势

1. **下拉刷新**
```json
// page.json
{
  "enablePullDownRefresh": true
}
```

2. **分享功能**
```javascript
onShareAppMessage() {
  return {
    title: '每日简报',
    path: '/pages/index/index'
  };
}
```

3. **订阅消息**（提醒用户看简报）

4. **扫码识别**（扫码直达某期简报）

## 六、部署流程

1. 微信开发者工具上传代码
2. 微信公众平台提交审核
3. 审核通过后发布

## 七、注意事项

- 小程序不能跳转外部网页（需用 web-view）
- 图片需使用网络地址或 base64
- 包大小限制 2MB（可分包）
- 需要 HTTPS 接口

需要我帮你写具体的小程序代码吗？